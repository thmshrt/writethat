library(devtools)
use_r('function_from_template.R')
use_r.function = function(file_path) {
text = "
#BEGIN: description
#\' {title placeholder}
#\'
#\' {description placeholder}
#\'
#\' @usage
#\' {usage placeholder}
#\'
#\' @param {param}   \\[{type}\\], {restrictions}
#\' @param {param}   \\[{type}\\], {restrictions}
#\'
#\' @return           [{type}]
#\'
#\' @export
#\' @importFrom magrittr %>%
#END: description
#BEGIN: code
myfun = function(
param1,
param2
) {
#BEGIN: setup params
#END: setup params
#BEGIN: param checks
#END: param checks
#BEGIN: computation
#END: computation
#BEGIN: return
#END: return
}
#END: code
#BEGIN: examples
#\' @examples
#\' #BEGIN: example
#\' # {case description}
#\' {code placeholder}
#\' #END: example
#\'
#\' #BEGIN: example
#\' # {case description}
#\' {code placeholder}
#\' #END: example
#\'
#\' #BEGIN: example
#\' # {case description}
#\' {code placeholder}
#\' #END: example
#END: examples
"
text %>% readr::write_file(file = file_path)
}
use_r.function('reformat_packaging.R')
library(magrittr)
use_package('magrittr')
use_package('readr')
library(readr)
use_r.function('reformat_packaging.R')
edit_file
use_r.function = function(
file_path,
edit_file = TRUE
) {
text = "
#BEGIN: description
#\' {title placeholder}
#\'
#\' {description placeholder}
#\'
#\' @usage
#\' {usage placeholder}
#\'
#\' @param {param}   \\[{type}\\], {restrictions}
#\' @param {param}   \\[{type}\\], {restrictions}
#\'
#\' @return           [{type}]
#\'
#\' @export
#\' @importFrom magrittr %>%
#END: description
#BEGIN: code
myfun = function(
param1,
param2
) {
#BEGIN: setup params
#END: setup params
#BEGIN: param checks
#END: param checks
#BEGIN: computation
#END: computation
#BEGIN: return
#END: return
}
use_r.function = function(
file_path,
edit_file = TRUE
) {
text = "
#BEGIN: description
#\' {title placeholder}
#\'
#\' {description placeholder}
#\'
#\' @usage
#\' {usage placeholder}
#\'
#\' @param {param}   \\[{type}\\], {restrictions}
#\' @param {param}   \\[{type}\\], {restrictions}
#\'
#\' @return           [{type}]
#\'
#\' @export
#\' @importFrom magrittr %>%
#END: description
#BEGIN: code
myfun = function(
param1,
param2
) {
#BEGIN: setup params
#END: setup params
#BEGIN: param checks
#END: param checks
#BEGIN: computation
#END: computation
#BEGIN: return
#END: return
}
#END: code
#BEGIN: examples
#\' @examples
#\' #BEGIN: example
#\' # {case description}
#\' {code placeholder}
#\' #END: example
#\'
#\' #BEGIN: example
#\' # {case description}
#\' {code placeholder}
#\' #END: example
#\'
#\' #BEGIN: example
#\' # {case description}
#\' {code placeholder}
#\' #END: example
#END: examples
"
text %>% readr::write_file(file = file_path)
if(edit_file)
if(rlang::is_interactive())
if(rstudioapi::isAvailable())
rstudioapi::navigateToFile(file_path)
}
use_r.function('reformat_packaging.R')
use_r.function('use_r.function.R')
use_package('rlang')
use_package('rstudioapi')
cat(sprintf('file_path exits: %s', file_path))
use_r.function = function(
file_path,
edit_file = TRUE
) {
#BEGIN: param checks
if (!(length(file_path) == 1))
rlang::abort(message = 'param file_path must satisfy length(v) == 1')
if (!(class(file_path) == 'character'))
rlang::abort(message = "param file_path must satisfy class(v) == 'character'")
if (!(length(edit_file) == 1))
rlang::abort(message = 'param edit_file must satisfy length(v) == 1')
if (!(class(edit_file) == 'logical'))
rlang::abort(message = "param file_path must satisfy class(v) == 'logical'")
#END: param checks
text = "
#BEGIN: description
#\' {title placeholder}
#\'
#\' {description placeholder}
#\'
#\' @usage
#\' {usage placeholder}
#\'
#\' @param {param}   \\[{type}\\], {restrictions}
#\' @param {param}   \\[{type}\\], {restrictions}
#\'
#\' @return           [{type}]
#\'
#\' @export
#\' @importFrom magrittr %>%
#END: description
#BEGIN: code
myfun = function(
param1,
param2
) {
#BEGIN: setup params
#END: setup params
#BEGIN: param checks
#END: param checks
#BEGIN: computation
#END: computation
#BEGIN: return
#END: return
}
""
"\"
""
}
which(1:3 == 0)
length(which(1:3 == 0))
use_package('stringi')
reformat_packaging = function(
file_path,
dry_run = TRUE
) {
#BEGIN: setup params
#END: setup params
#BEGIN: param checks
if (!(length(file_path) == 1))
rlang::abort(message = 'param file_path must satisfy length(v) == 1')
if (!(class(file_path) == 'character'))
rlang::abort(message = "param file_path must satisfy class(v) == 'character'")
if (!(length(dry_run) == 1))
rlang::abort(message = 'param dry_run must satisfy length(v) == 1')
if (!(class(dry_run) == 'logical'))
rlang::abort(message = "param dry_run must satisfy class(v) == 'logical'")
#END: param checks
#BEGIN: computation
file_path %>% readr::read_lines() -> lines
i_begin_description = which(lines == "#BEGIN: description")
i_end_description = which(lines == "#END: description")
i_begin_examples = which(lines == "#BEGIN: examples")
i_end_examples = which(lines == "#END: examples")
i_begin_code = which(lines == "#BEGIN: code")
i_end_code = which(lines == "#END: code")
if (!all(c(length(i_begin_description),length(i_end_description)) == 1))
rlang::abort(message = "'#BEGIN: description' and '#END: description' must occur exactly 1 time in file")
if (!all(c(length(i_begin_examples),length(i_end_examples)) == 1))
rlang::abort(message = "'#BEGIN: examples' and '#END: examples' must occur exactly 1 time in file")
if (!all(c(length(i_begin_code),length(i_end_code)) == 1))
rlang::abort(message = "'#BEGIN: code' and '#END: code' must occur exactly 1 time in file")
lines[
c(
# description goes first
(i_begin_description):(i_end_description),
# then examples
(i_begin_examples):(i_end_examples),
# then code
(i_begin_code):(i_end_code)
)
] -> reformated_lines
if (dry_run) {
reformmated_lines %>% stringi::stri_join(collapse = '\n') %>% cat()
} else {
reformmated_lines %>% readr::write_lines(file = file_path)
}
#END: computation
#BEGIN: return
#END: return
}
reformat_packaging('./reformat_packaging.R')
reformat_packaging = function(
file_path,
dry_run = TRUE
) {
#BEGIN: setup params
#END: setup params
#BEGIN: param checks
if (!(length(file_path) == 1))
rlang::abort(message = 'param file_path must satisfy length(v) == 1')
if (!(class(file_path) == 'character'))
rlang::abort(message = "param file_path must satisfy class(v) == 'character'")
if (!(length(dry_run) == 1))
rlang::abort(message = 'param dry_run must satisfy length(v) == 1')
if (!(class(dry_run) == 'logical'))
rlang::abort(message = "param dry_run must satisfy class(v) == 'logical'")
#END: param checks
#BEGIN: computation
file_path %>% readr::read_lines() -> lines
i_begin_description = which(lines == "#BEGIN: description")
i_end_description = which(lines == "#END: description")
i_begin_examples = which(lines == "#BEGIN: examples")
i_end_examples = which(lines == "#END: examples")
i_begin_code = which(lines == "#BEGIN: code")
i_end_code = which(lines == "#END: code")
if (!all(c(length(i_begin_description),length(i_end_description)) == 1))
rlang::abort(message = "'#BEGIN: description' and '#END: description' must occur exactly 1 time in file")
if (!all(c(length(i_begin_examples),length(i_end_examples)) == 1))
rlang::abort(message = "'#BEGIN: examples' and '#END: examples' must occur exactly 1 time in file")
if (!all(c(length(i_begin_code),length(i_end_code)) == 1))
rlang::abort(message = "'#BEGIN: code' and '#END: code' must occur exactly 1 time in file")
lines[
c(
# description goes first
(i_begin_description):(i_end_description),
# then examples
(i_begin_examples):(i_end_examples),
# then code
(i_begin_code):(i_end_code)
)
] -> reformated_lines
if (dry_run) {
reformated_lines %>% stringi::stri_join(collapse = '\n') %>% cat()
} else {
reformated_lines %>% readr::write_lines(file = file_path)
}
#END: computation
#BEGIN: return
#END: return
}
reformat_packaging('./reformat_packaging.R')
use_r.function('reformat_developing.R')
readr::read_lines('blah')
use_r.function('create_showcase.R')
edit_file('R/create_showcase.R')
edit_file('R/use_md.gitbook.R')
library(bookdown)
?bookdown::gitbook()
use_r.function('use_md.gitbook.R')
check()
